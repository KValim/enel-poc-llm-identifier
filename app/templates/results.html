<!DOCTYPE html>
<html>
<head>
    <title>Validation Results</title>
    <meta charset="UTF-8">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="/static/css/style.css" rel="stylesheet">
    <!-- Popper.js for Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="/static/js/script.js"></script>
</head>
<body>
    <div class="container">
        <!-- Page Header -->
        <h1 class="text-center my-4">Validation Results</h1>

        <!-- Validated Items Section -->
        <h2 class="section-header">Validated Items:</h2>
        <ul class="list-group">
            {% for item, status in encontrados.items() %}
                {% if status == 'Sim' %}
                    <li class="list-group-item item-sim" id="item-{{ loop.index }}" onclick="toggleDetails({{ loop.index }})">
                        <span>{{ item }}: <i class="icon-sim">✓</i></span>
                        {% if item in caracteristicas %}
                            <span class="arrow" id="arrow-{{ loop.index }}">&#8250;</span>
                        {% else %}
                            <span class="minus">&#8211;</span>
                        {% endif %}
                    </li>
                    {% if item in caracteristicas %}
                        <div id="details-{{ loop.index }}" class="details">
                            <ul>
                                {% for caract, valor in caracteristicas[item].items() %}
                                    {% if caract != 'Quantidade Identificada' %}
                                        <li>{{ caract }}: {{ valor }}</li>
                                    {% endif %}
                                {% endfor %}
                                {% if item != 'Quantidades' and caracteristicas[item].get('Quantidade Identificada') %}
                                    <li>Quantidade Identificada: {{ caracteristicas[item]['Quantidade Identificada'] }}</li>
                                {% endif %}
                            </ul>
                        </div>
                    {% endif %}
                {% endif %}
            {% endfor %}
        </ul>

        <!-- Exceptions Found Section -->
        <h2 class="section-header">Exceptions Found:</h2>
        <!-- Should Exist Subsection -->
        <h3 class="subsection-header">Should Exist:</h3>
        <ul class="list-group mb-4">
            {% for item, status in encontrados.items() %}
                {% if status == 'Não' %}
                    <li class="list-group-item item-nao">
                        <span>{{ item }}: <i class="icon-nao">✗</i></span>
                    </li>
                {% endif %}
            {% endfor %}
        </ul>

        <!-- Unplanned Found Items Subsection -->
        <h3 class="subsection-header">Unplanned Found Items:</h3>
        <ul class="list-group mb-4">
            {% for item in extras %}
                <li class="list-group-item item-nao-planejado" id="item-extra-{{ loop.index }}" onclick="toggleDetails('extra-{{ loop.index }}')">
                    <span>{{ item }}</span>
                    {% if item in caracteristicas %}
                        <span class="arrow" id="arrow-extra-{{ loop.index }}">&#8250;</span>
                    {% else %}
                        <span class="minus">&#8211;</span>
                    {% endif %}
                </li>
                {% if item in caracteristicas %}
                    <div id="details-extra-{{ loop.index }}" class="details">
                        <ul>
                            {% for caract, valor in caracteristicas[item].items() %}
                                <li>{{ caract }}: {{ valor }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
            {% endfor %}
        </ul>

        <!-- Comments Form -->
        <form method="post" action="{{ url_for('validation.results', project=project, post=post) }}">
            <div class="mb-3">
                <label for="comments" class="form-label">Comments:</label>
                <textarea class="form-control" id="comments" name="comments" rows="3"></textarea>
            </div>
            <!-- Form Buttons -->
            <button type="submit" name="action" value="validate_post" class="btn btn-success">Validate Structure</button>
            <button type="submit" name="action" value="invalidate_post" class="btn btn-danger">Invalidate Structure</button>
            <button type="submit" name="action" value="remove_photo" class="btn btn-warning">Remove Photo</button>
        </form>
        <!-- Back to Home Link -->
        <a href="/" class="btn btn-link">Home</a>
    </div>
</body>
</html>
